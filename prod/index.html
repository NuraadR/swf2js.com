<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>swf2js Production Version Demonstration</title>
    <meta content="このページにお持ちのSWFファイルをアップロード(DROP)する事で動作確認する事ができます。" name="descriptison">
    <meta content="swf2js,flash,html,swf" name="keywords">

    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon">
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="../assets/vendor/venobox/venobox.css" rel="stylesheet">
    <link href="../assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="../assets/css/style.css" rel="stylesheet">

    <!-- JavaScript Files -->
    <script src="https://swf2js-demonstration.s3-ap-northeast-1.amazonaws.com/swf2js.js.gz"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.704.0.min.js"></script>

    <!-- =======================================================
    * Template Name: MyResume - v2.1.0
    * Template URL: https://bootstrapmade.com/free-html-bootstrap-template-my-resume/
    * Author: BootstrapMade.com
    * License: https://bootstrapmade.com/license/
    ======================================================== -->
</head>

<body>

<!-- ======= Header ======= -->
<header id="header" class="d-flex flex-column justify-content-center">

    <nav class="nav-menu">
        <ul>
            <li><a href="../index.html"><i class="bx bx-menu"></i> <span>Japanese</span></a></li>
            <li><a href="../en/index.html"><i class="bx bx-menu"></i> <span>English</span></a></li>
        </ul>
    </nav><!-- .nav-menu -->

</header><!-- End Header -->

<div class="row content">

    <div class="col-lg-4 form-group sample-form">
        <select id="sample" class="custom-select" onchange="changeSample();">
            <option value="mp4_sample" selected>MP4 Sample Movie</option>
            <option value="reflection_butterfly">Reflection Butterfly</option>
        </select>
    </div>

    <div class="col-lg-4 form-group custom-file sample-form">
        <input id="inputFile" type="file" class="custom-file-input">
        <label class="custom-file-label" for="inputFile">Choose file</label>
    </div>

    <div class="col-lg-4 form-group sample-form">
        <button type="submit" id="upload-button" class="btn btn-primary">Upload</button>
    </div>

    <div class="col-lg-12 last-updated">
        Last Updated: 2020/7/12
    </div>

    <div class="col-lg-12 view">
        <div id="player" style="height: 480px;"></div>
    </div>

</div>

<!-- ======= Footer ======= -->
<footer id="footer">
    <div class="container">
        <h3>Samples provided</h3>
        <p>
            [MP4 Sample Movie]: <a href="https://mazwai.com/video/winter-wonderland-kiel/455096" target="_blank">Finn Karstens</a><br>
            [Reflection Butterfly]: <a href="http://clockmaker.jp/labs/" target="_blank">Clockmaker Labs</a>
        </p>

        <div class="copyright">
            &copy; Copyright <strong><span>Toshiyuki Ienaga</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
            <!-- All the links in the footer should remain intact. -->
            <!-- You can delete the links only if you purchased the pro version. -->
            <!-- Licensing information: [license-url] -->
            <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/free-html-bootstrap-template-my-resume/ -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
        </div>
    </div>
</footer><!-- End Footer -->

<!-- Vendor JS Files -->
<script src="../assets/vendor/jquery/jquery.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="../assets/vendor/jquery.easing/jquery.easing.min.js"></script>
<script src="../assets/vendor/php-email-form/validate.js"></script>
<script src="../assets/vendor/waypoints/jquery.waypoints.min.js"></script>
<script src="../assets/vendor/counterup/counterup.min.js"></script>
<script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="../assets/vendor/venobox/venobox.min.js"></script>
<script src="../assets/vendor/owl.carousel/owl.carousel.min.js"></script>
<script src="../assets/vendor/typed.js/typed.min.js"></script>
<script src="../assets/vendor/aos/aos.js"></script>
<script src="../assets/vendor/bs-custom-file-input/bs-custom-file-input.min.js"></script>

<!-- Template Main JS File -->
<script src="../assets/js/main.js"></script>

<script type="text/javascript">

    bsCustomFileInput.init();

    const button = document.getElementById("upload-button");
    button.addEventListener("click", function (event)
    {
        const fileChooser = document.getElementById("inputFile");
        const file = fileChooser.files[0];
        if (file) {

            const aKeys =  [65, 75, 73, 65, 53, 77, 77, 66, 69, 87, 68, 84, 50, 89, 51, 66, 53, 89, 76, 50];
            const sKeys =  [109, 52, 99, 47, 89, 50, 54, 52, 89, 54, 102, 114, 73, 74, 76, 66, 78, 81, 84, 105, 73, 77, 70, 66, 84, 87, 99, 81, 104, 55, 75, 89, 89, 119, 111, 73, 83, 53, 111, 73];

            // aws upload to s3
            AWS.config.update({
                "accessKeyId": String.fromCharCode.apply(null, aKeys),
                "secretAccessKey": String.fromCharCode.apply(null, sKeys),
                "region": "ap-northeast-1"
            });

            const bucket = new AWS.S3({ "params": {
                    "Bucket": "swf2js-demonstration"
                } });

            const fileName = (new Date()).getTime();

            const params = {
                "Key": "prod/" + fileName + ".swf",
                "ContentType": file.type,
                "Body": file
            };

            // upload
            bucket.putObject(params, function (error, data)
            {
                if (error) {

                    console.debug(error);

                } else {

                    localStorage.setItem("prod-url", "https://swf2js-demonstration.s3-ap-northeast-1.amazonaws.com/prod/" + fileName + ".swf");
                    document.location.reload();

                }

            });

        }
    });

    function changeSample ()
    {
        localStorage.setItem("prod-url", "../assets/swf/prod/" + document.getElementById("sample").value + ".swf");
        document.location.reload();
    }

    function start ()
    {
        let url = localStorage.getItem("prod-url");
        if (url) {

            localStorage.removeItem("prod-url");

            const name = url.split("/").pop().split(".")[0];
            const element = document.getElementById("sample");
            const length = element.options.length;
            for (let idx = 0; idx < length; ++idx) {

                if (element[idx].value !== name) {
                    continue;
                }

                element[idx].selected = true;

                break;
            }

        } else {
            url = "../assets/swf/prod/" + document.getElementById("sample").value + ".swf";
        }

        swf2js.load(url, { "tagId": "player" });
    }
    start();

</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-171581852-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-171581852-1');
</script>

</body>

</html>